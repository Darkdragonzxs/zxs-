<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cloudmoon Game Loader</title>
<style>
  body {
    margin: 0;
    background: #0b0b0b;
    font-family: "Inter", sans-serif;
    overflow: hidden;
  }

  iframe {
    width: 100vw;
    height: 100vh;
    border: none;
    position: relative;
    z-index: 1;
  }

  /* Logo */
  #logo {
    position: fixed;
    top: 16px;
    left: 16px;
    width: 60px;
    height: auto;
    z-index: 5000;
    pointer-events: none;
  }

  /* Overlay */
  #fullscreenOverlay,
  #welcomeScreen {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(18px) saturate(160%);
    -webkit-backdrop-filter: blur(18px) saturate(160%);
    background: rgba(25, 25, 25, 0.55);
    border: 1px solid rgba(255, 255, 255, 0.05);
    z-index: 2000;
    color: #eaeaea;
    text-align: center;
    opacity: 1;
    transition: opacity 0.6s ease-in-out;
  }

  #welcomeScreen {
    z-index: 3000;
  }

  /* Text */
  #welcomeScreen h1 {
    font-size: 3rem;
    margin-bottom: 12px;
    color: #ffffff;
  }

  #welcomeScreen p {
    font-size: 1.2rem;
    margin-bottom: 20px;
    color: #d0d0d0;
  }

  /* Buttons */
  button {
    padding: 14px 28px;
    font-size: 16px;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    background: #3a3f45;
    color: #f0f0f0;
    text-align: center;
    font-weight: 500;
    box-shadow: 0 4px 10px rgba(0,0,0,0.25);
    transition: all 0.2s ease;
  }

  button:hover {
    background: #4c5158;
    box-shadow: 0 6px 14px rgba(0,0,0,0.3);
  }

  button:active {
    background: #35393f;
    box-shadow: 0 3px 6px rgba(0,0,0,0.2);
  }

  button:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(138,180,248,0.4);
  }

  /* Inputs and selects */
  input, select {
    width: 260px;
    margin: 8px 0;
    padding: 12px;
    font-size: 15px;
    border-radius: 12px;
    border: 1px solid #555;
    background: #2c2f33;
    color: #eee;
    box-shadow: inset 0 2px 6px rgba(0,0,0,0.3);
    text-align: center;
    transition: all 0.2s ease;
  }

  input:focus, select:focus {
    outline: none;
    border-color: #8ab4f8;
    box-shadow: 0 0 8px rgba(138,180,248,0.5) inset;
  }

  /* Steps */
  .step {
    opacity: 0;
    display: none;
    flex-direction: column;
    align-items: center;
  }

  .step.active {
    opacity: 1;
    display: flex;
  }

  /* Dialogue box */
  #dialogueBox {
    margin-top: 12px;
    padding: 12px 18px;
    width: 240px;
    font-size: 14px;
    background: rgba(50, 50, 50, 0.45);
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.05);
    color: #cfd4da;
    text-align: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  }

  #statusMessage {
    margin-top: 20px;
    font-size: 17px;
    color: #f0f0f0;
  }

  #loadingBarContainer {
    width: 260px;
    height: 10px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    overflow: hidden;
    margin-top: 20px;
    display: none;
  }

  #loadingBar {
    width: 0%;
    height: 100%;
    background: linear-gradient(90deg, #0f0f0f, #A9A9A9);
    border-radius: 8px;
    transition: width 0.6s ease;
  }

  #blocker {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0);
    z-index: 4000;
    display: none;
  }
</style>
</head>
<body>
<img src="/assets/images/luna.png" alt=".LUNA Logo" id="logo">

<iframe src="/cloudmoon/game/com.roblox.client/"></iframe>

<div id="welcomeScreen">
  <h1>Welcome to .LUNA.</h1>
  <p>Your ultimate cloud gaming experience starts now.</p>
  <button id="enterBtn">Enter</button>
</div>

<div id="fullscreenOverlay" style="display:none;">
  <h2 id="titleText">Click Play</h2>

  <button id="playBtn" class="step active">Play</button>

  <div id="serverSelectContainer" class="step">
    <h3>Select Server</h3>
    <select id="serverSelect">
      <option>US West</option>
      <option>US East</option>
      <option>Europe</option>
      <option>Asia</option>
    </select>
    <button id="nextServer">Next</button>
  </div>

  <div id="signInPasswordContainer" class="step">
    <button id="signInPasswordBtn">Sign in with password</button>
  </div>

  <div id="loginContainer" class="step">
    <input type="text" placeholder="Google account email">
    <input type="password" placeholder="Password">
    <div id="dialogueBox">Make sure to use your Cloudmoon credentials.</div>
    <div style="margin-top:8px; font-size:12px; color:#aaa; text-align:center;">
      We never store your Google credentials. Use at your own risk.
    </div>
    <button id="confirmLogin">Sign in</button>
  </div>

  <div id="clickPlayContainer" class="step">
    <button id="clickPlayBtn">Click Play</button>
  </div>

  <div id="finalPlayContainer" class="step">
    <button id="finalPlayBtn">Play Game</button>
  </div>

  <div id="loadingBarContainer"><div id="loadingBar"></div></div>
  <div id="statusMessage"></div>
</div>

<div id="blocker"></div>

<script>
const welcomeScreen = document.getElementById("welcomeScreen");
const enterBtn = document.getElementById("enterBtn");
const overlay = document.getElementById("fullscreenOverlay");
const blocker = document.getElementById("blocker");

enterBtn.onclick = () => {
  welcomeScreen.style.display = "none";
  overlay.style.display = "flex";
};

const steps = [
  "playBtn",
  "serverSelectContainer",
  "signInPasswordContainer",
  "loginContainer",
  "clickPlayContainer",
  "finalPlayContainer"
];

let currentStep = 0;
const titleText = document.getElementById("titleText");
const statusMsg = document.getElementById("statusMessage");
const loadingBarContainer = document.getElementById("loadingBarContainer");
const loadingBar = document.getElementById("loadingBar");

function showStep(index) {
  steps.forEach((id, i) => {
    const el = document.getElementById(id);
    if (i === index) {
      el.classList.add("active");
    } else {
      el.classList.remove("active");
    }
  });
  titleText.textContent = [
    "Click Play",
    "Select Server",
    "Click Sign in with Password",
    "Confirm Login",
    "Click Play",
    "Play Game"
  ][index];
}

function nextStep() {
  currentStep++;
  if (currentStep < steps.length) showStep(currentStep);
}

function disableAllInputs(disabled) {
  document.querySelectorAll("button, select, input").forEach(el => el.disabled = disabled);
  blocker.style.display = disabled ? "block" : "none";
}

function startLoading() {
  disableAllInputs(true);
  loadingBarContainer.style.display = "block";
  statusMsg.textContent = "Loading...";
  let progress = 0;
  const interval = setInterval(() => {
    progress += Math.random() * 8;
    loadingBar.style.width = Math.min(progress, 100) + "%";
    if (progress >= 100) {
      clearInterval(interval);
      disableAllInputs(false);
      loadingBar.style.width = "100%";
      statusMsg.textContent = "";
    }
  }, 200);
}

function finishLoading() {
  statusMsg.textContent = "Enjoy your game!";
  loadingBarContainer.style.display = "none";
}

document.getElementById("playBtn").onclick = nextStep;
document.getElementById("nextServer").onclick = nextStep;
document.getElementById("signInPasswordBtn").onclick = nextStep;
document.getElementById("confirmLogin").onclick = () => {
  startLoading();
  nextStep();
};
document.getElementById("clickPlayBtn").onclick = nextStep;
document.getElementById("finalPlayBtn").onclick = finishLoading;

showStep(currentStep);
</script>
</body>
</html>
